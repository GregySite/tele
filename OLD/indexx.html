<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Greg TV</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="https://play-lh.googleusercontent.com/dU2w3eCjd-u5ifnlcaoPiQFdbiSKwIWVP6fH9z9aDmVkV22p3syf02ZYrKfKNm8bqiU">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <style>
    html, body { height: 100%; margin: 0; padding: 0; background: #121212; color: white; font-family: sans-serif; overflow: hidden; }
    
    /* Barre de Token */
    #token-bar { display: flex; align-items: center; gap: 8px; padding: 10px; background: #1a1a1a; height: 50px; box-sizing: border-box; }
    #tokenInput { flex: 1; max-width: 250px; padding: 5px; background: #1e1e1e; color: white; border: 1px solid #333; border-radius: 4px; }
    #tokenStatus { font-size: 22px; cursor: pointer; }

    /* Layout principal */
    #main { display: flex; height: calc(100vh - 50px); flex-direction: row; }

    /* Liste des chaînes */
    #channel-list { flex: 0 0 260px; overflow-y: auto; background-color: #1a1a1a; padding: 10px; border-right: 1px solid #333; }
    .channel { border: 1px solid #333; border-radius: 5px; padding: 10px; margin-bottom: 10px; cursor: pointer; background: #222; display: flex; align-items: center; transition: 0.2s; }
    .channel:hover { background: #333; }
    .channel.active { border-color: #ff0000; background: #2a1010; }
    .channel img { width: 40px; height: 30px; object-fit: contain; margin-right: 12px; background: #000; border-radius: 3px; }
    .channel-name { font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    /* Conteneur Vidéo */
    #video-container { flex: 1; background: black; display: flex; flex-direction: column; justify-content: center; position: relative; }
    video { width: 100%; height: auto; max-height: 100%; outline: none; }
    
    .controls { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 10px; opacity: 0.5; transition: 0.3s; }
    .controls:hover { opacity: 1; }
    .btn { padding: 10px 15px; background: rgba(50,50,50,0.8); color: white; border: none; cursor: pointer; border-radius: 5px; font-weight: bold; }

    /* --- RESPONSIVE SMARTPHONE --- */
    /* Mode PORTRAIT : Vidéo en haut, Liste en bas */
    @media (max-width: 768px) and (orientation: portrait) {
      #main { flex-direction: column; }
      #video-container { flex: 0 0 auto; width: 100%; aspect-ratio: 16/9; }
      #channel-list { flex: 1; border-right: none; border-top: 1px solid #333; }
      .controls { bottom: 5px; scale: 0.8; }
    }

    /* Mode PAYSAGE : Liste à gauche (plus étroite), Vidéo à droite */
    @media (max-height: 500px) and (orientation: landscape) {
      #token-bar { display: none; } /* On cache la barre de token pour gagner de la place */
      #main { height: 100vh; }
      #channel-list { flex: 0 0 180px; }
    }

    /* Modal Scan */
    #qr-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 10000; justify-content: center; align-items: center; }
    #qr-content { background: white; padding: 20px; border-radius: 10px; color: black; width: 90%; max-width: 400px; text-align: center; }
    #reader { width: 100%; }
  </style>
</head>
<body>

  <div id="token-bar">
    <span style="font-size: 10px; color: #555;">v2.0</span>
    <input type="text" id="tokenInput" readonly>
    <span id="tokenStatus" onclick="handleTokenClick()">⏳</span>
  </div>

  <div id="main">
    <div id="channel-list" id="list"></div>

    <div id="video-container">
      <video id="video" controls autoplay playsinline></video>
      <div class="controls">
        <button class="btn" onclick="changeChannel(-1)">Précédent</button>
        <button class="btn" onclick="changeChannel(1)">Suivant</button>
      </div>
    </div>
  </div>

  <div id="qr-modal">
    <div id="qr-content">
      <h3 id="qr-title">Scanner le Token</h3>
      <div id="reader"></div>
      <button onclick="closeModal()" style="margin-top:15px; width:100%; padding:12px; background:#ff4444; color:white; border:none; border-radius:5px; font-weight:bold;">ANNULER</button>
    </div>
  </div>

  <script>
    // --- COLLEZ VOTRE LISTE CI-DESSOUS ---
  const channels = [
    { name: "TF1", id: "tf1", url: "https://live1-iix.annatel.tv/smooths_live/tf1.isml/tf1.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/b/bc/Logo_TF1_2013.svg" },
    { name: "France 2", id: "france2", url: "https://live1-iix.annatel.tv/smooths_live/france2.isml/france2.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/c/c3/France_2_logo_2018.svg" },
    { name: "France 3", id: "france3", url: "https://live1-iix.annatel.tv/smooths_live/france3.isml/france3.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/d/d6/France_3_logo_2018.svg" },
    { name: "Canal+", id: "canalplus", url: "https://live1-iix.annatel.tv/smooths_live/canalplus.isml/canalplus.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/1/1a/Canal%2B_2009.svg" },
    { name: "France 5", id: "france5", url: "https://live1-iix.annatel.tv/smooths_live/france5.isml/france5.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/4/4e/France_5_logo_2018.svg" },
    { name: "M6", id: "m6", url: "https://live1-iix.annatel.tv/smooths_live/m6.isml/m6.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/a/af/M6_logo_2009.svg" },
    { name: "Arte", id: "arte", url: "https://live1-iix.annatel.tv/smooths_live/arte.isml/arte.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/b/b3/Arte_logo_2017.svg" },
    { name: "TMC", id: "tmc", url: "https://live1-iix.annatel.tv/smooths_live/tmc.isml/tmc.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/e/e0/TMC_logo_2016.svg" },
    { name: "NT1", id: "nt1", url: "https://live1-iix.annatel.tv/smooths_live/nt1.isml/nt1.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/6/67/TFX_logo_2018.svg" },
    { name: "W9", id: "w9", url: "https://live1-iix.annatel.tv/smooths_live/w9.isml/w9.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/e/e3/W9_logo_2022.svg" },
    { name: "Annatel+", id: "annatelplus", url: "https://replay1-il.annatel.tv/annatelplus/video.m3u8", logo: "https://scontent.ftlv5-1.fna.fbcdn.net/v/t39.30808-6/559579573_1119929050319731_9172703091283405295_n.jpg?_nc_cat=107&ccb=1-7&_nc_sid=6ee11a&_nc_ohc=osEJyv7K1tYQ7kNvwGr1oh0&_nc_oc=AdmT06qY9n-zVHmFY-SUAcFfHHbetWSqf3KHpt1g4luDkq74CaHquVD9PSQnC1lrYy4PcUxhWVZ_iiB9H9087hzh&_nc_zt=23&_nc_ht=scontent.ftlv5-1.fna&_nc_gid=bQQ6qDRFlhsMbvX_W10csg&oh=00_Afkqc2Rzs7Xt0towIlG5mGWuWAn2wDmZDzli51KnuOmftw&oe=694F977D" },
    { name: "Tandem", id: "tandem", url: "https://replay1-il.annatel.tv/tandem/video.m3u8", logo: "https://scontent.ftlv5-1.fna.fbcdn.net/v/t39.30808-6/218693611_3861781053933764_3626944450371459354_n.jpg?_nc_cat=101&ccb=1-7&_nc_sid=6ee11a&_nc_ohc=GqoQehg9yy8Q7kNvwHjXnk1&_nc_oc=AdlQc_HLscTihf63a2B0r3_XG3_FtUvi9zTmoKssYwTh0lKSyosEx9uSpsWOnEZsrEKRs3gidc0r862GTVQP7Dzk&_nc_zt=23&_nc_ht=scontent.ftlv5-1.fna&_nc_gid=yBNSCLkJHrU3zlBHeTz0MQ&oh=00_Afn6jHqcGHdyEIub8ZSTMe2rjRc-sjtdq5Ro0B93wdfOMw&oe=694F8ECA" },
    { name: "Bfm Tv", id: "bfmtv", url: "https://live1-iix.annatel.tv/smooths_live/bfmtv.isml/bfmtv.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/e/e5/BFM_TV_logo_2019.svg" },
    { name: "iTele", id: "itele", url: "https://live1-iix.annatel.tv/smooths_live/itele.isml/itele.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/3/30/CNews_logo_2017.svg" },
    { name: "D17", id: "d17", url: "https://live1-iix.annatel.tv/smooths_live/d17.isml/d17.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/c/c5/CStar_logo_2017.svg" },
    { name: "TF1 series films", id: "hd1", url: "https://live1-iix.annatel.tv/smooths_live/hd1.isml/hd1.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/5/52/TF1_S%C3%A9ries_Films_logo_2018.svg" },
    { name: "L'Equipe 21", id: "lequipe", url: "https://live1-iix.annatel.tv/smooths_live/lequipe.isml/lequipe.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/3/3d/L%27%C3%89quipe_logo_2017.svg" },
    { name: "6Ter", id: "6ter", url: "https://live1-iix.annatel.tv/smooths_live/6ter.isml/6ter.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/b/b3/6ter_logo_2012.svg" },
    { name: "RMC Story", id: "num23", url: "https://live1-iix.annatel.tv/smooths_live/num23.isml/num23.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/e/ec/RMC_Story_logo_2018.svg" },
    { name: "i24 News fr", id: "i24newsfr", url: "https://live1-iix.annatel.tv/smooths_live/i24_news_fr.isml/i24_news_fr.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/0/05/I24_News_logo.svg" },
    { name: "Cherie 25", id: "cherie25", url: "https://live1-iix.annatel.tv/smooths_live/cherie25.isml/cherie25.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/c/cd/Ch%C3%A9rie_25_logo_2012.svg" },
    { name: "RMC Decouverte", id: "rmc_decouverte", url: "https://live1-iix.annatel.tv/smooths_live/rmc_decouverte.isml/rmc_decouverte.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/e/e0/RMC_D%C3%A9couverte_logo_2012.svg" },
    { name: "BEIN Sport 1", id: "beinsport1", url: "https://live1-iix.annatel.tv/smooths_live/beinsport1.isml/beinsport1.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/1/1d/BeIN_Sports_1_logo_2017.svg" },
    { name: "BEIN Sport 2", id: "beinsport2", url: "https://live1-iix.annatel.tv/smooths_live/beinsport2.isml/beinsport2.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/5/56/BeIN_Sports_2_logo_2017.svg" },
    { name: "BEIN Sport 1 HD", id: "beinsport1hd", url: "https://live1-iix.annatel.tv/smooths_live/beinsport1hd.isml/beinsport1hd.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/1/1d/BeIN_Sports_1_logo_2017.svg" },
    { name: "BEIN Sport 2 HD", id: "beinsport2hd", url: "https://live1-iix.annatel.tv/smooths_live/beinsport2hd.isml/beinsport2hd.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/5/56/BeIN_Sports_2_logo_2017.svg" },
    { name: "BEIN Sport 3", id: "beinsport3", url: "https://live1-iix.annatel.tv/smooths_live/beinsport3.isml/beinsport3.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/0/00/BeIN_Sports_3_logo_2017.svg" },
    { name: "SFR Sport 1", id: "sfrsport1", url: "https://live1-iix.annatel.tv/smooths_live/sfrsport1.isml/sfrsport1.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/e/e4/Logo_SFR_Sport_1_2016.svg" },
    { name: "SFR Sport 2", id: "sfrsport2", url: "https://live1-iix.annatel.tv/smooths_live/sfrsport2.isml/sfrsport2.m3u8", logo: "https://upload.wikimedia.org/wikipedia/fr/e/e9/Logo_SFR_Sport_2_2016.svg" },
    { name: "SFR Sport 3", id: "sfrsport3", url: "https://live1-iix.annatel.tv/smooths_live/sfrsport3.isml/sfrsport3.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/8/80/Logo_SFR_Sport_3_2016.svg" },
    { name: "Canal Cinema", id: "canalplus_cinema", url: "https://live1-iix.annatel.tv/smooths_live/canalplus_cinema.isml/canalplus_cinema.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/5/51/Canal%2B_Cin%C3%A9ma_logo_2023.svg" },
    { name: "Canal Sport", id: "canalplus_sport", url: "https://live1-iix.annatel.tv/smooths_live/canalplus_sport.isml/canalplus_sport.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/a/a2/Canal%2B_Sport_logo_2023.svg" },
    { name: "Cine+ Premier", id: "cineplus_premier", url: "https://live1-iix.annatel.tv/smooths_live/cineplus_premier.isml/cineplus_premier.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/f/fa/Logo_Cin%C3%A9%2B_Premier_2011.svg" },
    { name: "Cine+ Frisson", id: "cineplus_frisson", url: "https://live1-iix.annatel.tv/smooths_live/cineplus_frisson.isml/cineplus_frisson.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/c/ce/Logo_Cin%C3%A9%2B_Frisson_2011.svg" },
    { name: "Cine+ Famiz", id: "cineplus_famiz", url: "https://live1-iix.annatel.tv/smooths_live/cineplus_famiz.isml/cineplus_famiz.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/a/a2/Logo_Cin%C3%A9%2B_Famiz_2011.svg" },
    { name: "M6 Inter", id: "m6_inter", url: "https://live1-iix.annatel.tv/smooths_live/m6_inter.isml/m6_inter.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/a/af/M6_logo_2009.svg" },
    { name: "RTL9", id: "rtl9", url: "https://live1-iix.annatel.tv/smooths_live/rtl9.isml/rtl9.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/d/d4/RTL9_logo_2023.svg" },
    { name: "Comedie", id: "comedie", url: "https://live1-iix.annatel.tv/smooths_live/comedie.isml/comedie.m3u8", logo: "https://thumb.canalplus.pro/bran/unsafe/1920x/filters:quality(%7BimageQualityPercentage%7D)/image/6894a30693fc3/uploads/media/COMEDIE.png" },
    { name: "Euro News", id: "euronews", url: "https://live1-iix.annatel.tv/smooths_live/euronews.isml/euronews.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/4/41/Euronews_2016.svg" },
    { name: "Equidia", id: "equidia", url: "https://live1-iix.annatel.tv/smooths_live/equidia.isml/equidia.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/c/c5/Equidia_logo_2021.svg" },
    { name: "TF1 HD", id: "tf1hd", url: "https://live1-iix.annatel.tv/smooths_live/tf1hd.isml/tf1hd.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/4/43/TF1_logo_2013.svg" },
    { name: "France 2 HD", id: "france2hd", url: "https://live1-iix.annatel.tv/smooths_live/france2hd.isml/france2hd.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/c/c3/France_2_logo_2018.svg" },
    { name: "Canal+ HD", id: "canalplushd", url: "https://live1-iix.annatel.tv/smooths_live/canalplushd.isml/canalplushd.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/1/1a/Canal%2B_2009.svg" },
    { name: "M6 HD", id: "m6hd", url: "https://live1-iix.annatel.tv/smooths_live/m6hd.isml/m6hd.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/a/af/M6_logo_2009.svg" },
    { name: "Canal Sport HD", id: "canalsporthd", url: "https://live1-iix.annatel.tv/smooths_live/canalplus_sport_hd.isml/canalplus_sport_hd.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/a/a2/Canal%2B_Sport_logo_2023.svg" },
    { name: "Info Sport", id: "infosport", url: "https://live1-iix.annatel.tv/smooths_live/infosport.isml/infosport.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/2/23/Infosport%2B_logo_2023.svg" },
    { name: "Gulli", id: "gulli", url: "https://live1-iix.annatel.tv/smooths_live/gulli.isml/gulli.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/d/d3/Gulli_logo_2017.svg" },
    { name: "Nickelodeon Junior", id: "nickelodeon_junior", url: "https://live1-iix.annatel.tv/smooths_live/nickelodeon_junior.isml/nickelodeon_junior.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/0/07/Nickelodeon_Junior_logo_2010.svg" },
    { name: "Planete", id: "planete", url: "https://live1-iix.annatel.tv/smooths_live/planete.isml/planete.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/e/e8/Plan%C3%A8te%2B_logo_2011.svg" },
    { name: "A Tv Cpp", id: "atvcpp", url: "https://live1-iix.annatel.tv/smooths_live/atvcpp.isml/atvcpp.m3u8", logo: "https://yt3.googleusercontent.com/ytc/AIdro_nZd3pEX0jd_y1KuNG-_zIM9diLpJKrAVLoFtm2kVKTnw=s160-c-k-c0x00ffffff-no-rj" },
    { name: "Eurosport 1", id: "eurosport1", url: "https://live1-iix.annatel.tv/smooths_live/eurosport1.isml/eurosport1.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/3/30/Eurosport_1_logo_2015.svg" },
    { name: "Eurosport 2", id: "eurosport2", url: "https://live1-iix.annatel.tv/smooths_live/eurosport2.isml/eurosport2.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/7/75/Eurosport_2_logo_2015.svg" },
    { name: "ISRAEL TORAH", id: "israel_torah", url: "https://live1-iix.annatel.tv/smooths_live/israel_torah.isml/israel_torah.m3u8", logo: "https://yt3.googleusercontent.com/ewkDfk-RxY2V_uaZBrnnBRDVnzOyfAagowuAPO7rOSJ5kxwpZt7r5USEIHgTz5XyQR0Qx9E0cA=s160-c-k-c0x00ffffff-no-rj" },
    { name: "i24 News IL", id: "i24newsil", url: "https://live1-iix.annatel.tv/smooths_live/i24_news_he.isml/i24_news_he.m3u8", logo: "https://upload.wikimedia.org/wikipedia/commons/0/05/I24_News_logo.svg" }
];

  // --- FIN DE VOTRE LISTE ---
  </script>

  <script>
    const video = document.getElementById('video');
    const listContainer = document.getElementById('channel-list');
    const tokenInput = document.getElementById('tokenInput');
    const tokenStatus = document.getElementById('tokenStatus');
    let currentIdx = 0;
    let html5QrCode;

    // --- GESTION TOKEN & SCAN ---
    function handleTokenClick() {
      const savedToken = localStorage.getItem("tvToken");
      if (savedToken && savedToken.length > 5) {
        if (confirm("Token déjà valide (✅). Voulez-vous scanner un nouveau code ?")) {
          openModal();
        }
      } else {
        openModal();
      }
    }

    function openModal() {
      document.getElementById('qr-modal').style.display = 'flex';
      if (!html5QrCode) html5QrCode = new Html5Qrcode("reader");
      html5QrCode.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, (text) => {
        saveToken(text);
        closeModal();
      }).catch(err => alert("Erreur caméra : " + err));
    }

    function closeModal() {
      document.getElementById('qr-modal').style.display = 'none';
      if (html5QrCode) html5QrCode.stop();
    }

    function saveToken(val) {
      localStorage.setItem("tvToken", val);
      tokenInput.value = val;
      tokenStatus.textContent = "✅";
    }

    // --- LOGIQUE CHAÎNES ---
    function initApp() {
      const saved = localStorage.getItem("tvToken");
      if (saved) { tokenInput.value = saved; tokenStatus.textContent = "✅"; }

      channels.forEach((ch, index) => {
        const div = document.createElement('div');
        div.className = 'channel';
        div.id = 'ch-' + index;
        div.innerHTML = `<img src="${ch.logo || 'https://via.placeholder.com/40x30?text=TV'}" onerror="this.src='https://via.placeholder.com/40x30?text=TV'">
                         <span class="channel-name">${ch.name}</span>`;
        div.onclick = () => playChannel(index);
        listContainer.appendChild(div);
      });
      playChannel(0);
    }

    function playChannel(index) {
      document.querySelectorAll('.channel').forEach(el => el.classList.remove('active'));
      document.getElementById('ch-' + index).classList.add('active');
      currentIdx = index;
      
      const token = localStorage.getItem("tvToken") || "";
      const finalUrl = channels[index].url + (token ? "?token=" + token : "");
      
      video.src = finalUrl;
      video.play().catch(() => {});
      
      // Auto-scroll de la liste
      document.getElementById('ch-' + index).scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function changeChannel(dir) {
      let newIdx = currentIdx + dir;
      if (newIdx >= 0 && newIdx < channels.length) playChannel(newIdx);
    }

    window.onload = initApp;
  </script>
</body>
</html>
